<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>How Soda SQL works - Soda Documentation</title> <link rel="shortcut icon" href="/soda-sql/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/soda-sql/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/soda-sql/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/soda-sql/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>How Soda SQL works | Soda Documentation</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="How Soda SQL works" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Learn how to use Soda to test and monitor data quality." /> <meta property="og:description" content="Learn how to use Soda to test and monitor data quality." /> <link rel="canonical" href="/soda-sql/documentation/concepts.html" /> <meta property="og:url" content="/soda-sql/documentation/concepts.html" /> <meta property="og:site_name" content="Soda Documentation" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="How Soda SQL works" /> <script type="application/ld+json"> {"url":"/soda-sql/documentation/concepts.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/soda-sql/assets/images/soda-logo.svg"}},"description":"Learn how to use Soda to test and monitor data quality.","@type":"WebPage","headline":"How Soda SQL works","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/soda-sql/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"> <li class="nav-list-item "> <a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"> <use xlink:href="#svg-arrow-right"></use> </svg></a> <a class="nav-list-link" href="/soda-sql/getting-started/5_min_tutorial.html">Get Started</a> <ul class="nav-list "> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/getting-started/5_min_tutorial.html">Quick start tutorial</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/getting-started/installation.html">Install Soda SQL</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/getting-started/configure.html">Configure Soda SQL</a> </li> </ul> </li> <li class="nav-list-item active"> <a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"> <use xlink:href="#svg-arrow-right"></use> </svg></a> <a class="nav-list-link" href="/soda-sql/documentation/concepts.html">Documentation</a> <ul class="nav-list "> <li class="nav-list-item"> <a class="nav-list-link active" href="/soda-sql/documentation/concepts.html">How Soda SQL works</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/cli.html">Soda SQL CLI commands</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/warehouse.html">Warehouse YAML</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/warehouse_types.html">Set warehouse configuration</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/scan.html">Scan YAML</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/sql_metrics.html">Metrics</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/tests.html">Tests</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/filtering.html">Apply filters</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/programmatic_scan.html">Configure programmatic scans</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/orchestrate_scans.html">Configure orchestrated scans</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/soda-cloud-architecture.html">Soda Cloud Architecture</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/connect_to_cloud.html">Connect to Soda Cloud</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/monitors.html">Create monitors and alerts</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/integrate-slack.html">Integrate with Slack</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/troubleshoot.html">Troubleshoot</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/glossary.html">Glossary</a> </li> </ul> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/community.html">Community</a> </li> </ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Soda Documentation" aria-label="Search Soda Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/sodadata/soda-sql" class="site-button" > Soda SQL on GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">Documentation</a></li> <li class="breadcrumb-nav-list-item"><span>How Soda SQL works</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="how-soda-sql-works"> <a href="#how-soda-sql-works" class="anchor-heading" aria-labelledby="how-soda-sql-works"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How Soda SQL works </h1> <p><strong>Soda SQL</strong> is an open-source command-line tool. It utilizes user-defined input to prepare SQL queries that run tests on tables in a database to find invalid, missing, or unexpected data. When tests fail, they surface the data that you defined as “bad” in the tests. Armed with this information, you and your data engineering team can diagnose where the “bad” data entered your data pipeline and take steps to prioritize and resolve issues based on downstream impact.</p> <p>Use Soda SQL on its own to manually or programmatically scan the data that your organization uses to make decisions. Optionally, you can integrate Soda SQL with your data orchestration tool to schedule scans and automate actions based on scan results. Further, you can connect Soda SQL to a free <strong>Soda Cloud</strong> account where you and your team can use the web application to monitor test results and collaborate to keep your data issue-free.</p> <h2 id="soda-sql-basics"> <a href="#soda-sql-basics" class="anchor-heading" aria-labelledby="soda-sql-basics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Soda SQL basics </h2> <p>This open-source, command-line tool exists to enable Data Engineers to access and test data inside <a href="/soda-sql/documentation/glossary.html#warehouse">warehouses</a>. The first of what will soon be many such developer tools, Soda SQL allows you to perform three basic tasks:</p> <ul> <li>connect to your warehouse,</li> <li>define tests for “bad” data, and,</li> <li>scan your <a href="/soda-sql/documentation/glossary.html#table">table</a> to run tests for “bad” data.</li> </ul> <p>To <strong>connect</strong> to a data warehouse such as Snowflake, AWS Athena, or Google Cloud Products BigQuery, you use two files that Soda SQL creates for you when you run the <code class="language-plaintext highlighter-rouge">soda create</code> CLI command:</p> <ul> <li>a <code class="language-plaintext highlighter-rouge">warehouse.yml</code> file which stores access details for your warehouse, and,</li> <li>an <code class="language-plaintext highlighter-rouge">env_vars.yml</code> file which securely stores warehouse login credentials.</li> </ul> <h4 id="warehouse-yaml-example"> <a href="#warehouse-yaml-example" class="anchor-heading" aria-labelledby="warehouse-yaml-example"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Warehouse YAML example </h4> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">name</span><span class="pi">:</span> <span class="s">soda_sql_tutorial</span>
<span class="na">connection</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">postgres</span>
  <span class="na">host</span><span class="pi">:</span> <span class="s">localhost</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">env_var(POSTGRES_USERNAME)</span>
  <span class="na">password</span><span class="pi">:</span> <span class="s">env_var(POSTGRES_PASSWORD)</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">sodasql</span>
  <span class="na">schema</span><span class="pi">:</span> <span class="s">public</span>
</code></pre></div></div> <h4 id="env_vars-yaml-example"> <a href="#env_vars-yaml-example" class="anchor-heading" aria-labelledby="env_vars-yaml-example"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> env_vars YAML example </h4> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">soda_sql_tutorial</span><span class="pi">:</span>
  <span class="na">POSTGRES_USERNAME</span><span class="pi">:</span> <span class="s">xxxxxx</span>
  <span class="na">POSTGRES_PASSWORD</span><span class="pi">:</span> <span class="s">yyyyyy</span>
</code></pre></div></div> <p>To <strong>define</strong> the data quality tests that Soda SQL runs against a table in your warehouse, you use the scan YAML files that Soda SQL creates when you run the <code class="language-plaintext highlighter-rouge">soda analyze</code> CLI command. Soda SQL uses the Warehouse YAML file to connect to your warehouse and analyze the tables in it. For every table that exists, Soda SQL creates a corresponding scan YAML file and automatically populates it with tests it deems relevant for your data. You can keep these default tests intact, or you can adjust them or add more tests to fine-tune your search for “bad” data.</p> <p>For example, you can define tests that look for things like, non-UUID entries in the id column of a table, or zero values in a commission percentage column. See <a href="/soda-sql/documentation/scan.html">Scan YAML</a> for much more detail on the contents of this file.</p> <h4 id="scan-yaml-example"> <a href="#scan-yaml-example" class="anchor-heading" aria-labelledby="scan-yaml-example"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Scan YAML example </h4> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">table_name</span><span class="pi">:</span> <span class="s">demodata</span>
<span class="na">metrics</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">row_count</span>
  <span class="pi">-</span> <span class="s">missing_count</span>
  <span class="pi">-</span> <span class="s">missing_percentage</span>
  <span class="pi">-</span> <span class="s">...</span>
<span class="na">tests</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">row_count &gt; </span><span class="m">0</span>
<span class="na">columns</span><span class="pi">:</span>
  <span class="na">id</span><span class="pi">:</span>
    <span class="na">valid_format</span><span class="pi">:</span> <span class="s">uuid</span>
    <span class="na">tests</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">invalid_percentage == </span><span class="m">0</span>
</code></pre></div></div> <p>To <strong>scan</strong> your data, you use the <code class="language-plaintext highlighter-rouge">soda scan</code> CLI command. Soda SQL uses the input in the scan YAML file to prepare SQL queries that it runs against the data in a table in a warehouse. All tests return true or false; if true, the test passed and you know your data is sound; if false, the test fails which means the scan discovered data that falls outside the expected or acceptable parameters you defined in your test.</p> <h2 id="soda-sql-operation"> <a href="#soda-sql-operation" class="anchor-heading" aria-labelledby="soda-sql-operation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Soda SQL operation </h2> <p>Imagine you have installed Soda SQL, you have run the <code class="language-plaintext highlighter-rouge">soda create</code> command to set up your Warehouse and env_vars YAML files, and you have added your warehouse login credentials to the env_vars YAML. You have run <code class="language-plaintext highlighter-rouge">soda analyze</code>, and you have some new scan YAML files in your <code class="language-plaintext highlighter-rouge">/tables</code> directory that map to tables in your database. You are ready to scan!</p> <p>The following image illustrates what Soda SQL does when you initiate a scan.</p> <p><img src="../assets/images/soda-operation.png" alt="soda-operation" height="800px" width="800px" /></p> <p><strong>1</strong> - You trigger a scan using the <code class="language-plaintext highlighter-rouge">soda scan</code> CLI command from your <a href="/soda-sql/documentation/glossary.html#warehouse-directory">warehouse directory</a>. The scan specifies which Warehouse YAML and scan YAML files to use, which amounts to telling it which table in which warehouse to scan.</p> <p><strong>2</strong> - Soda SQL uses the tests in the scan YAML to prepare SQL queries that it runs on the tables in your warehouse.</p> <p><strong>3</strong> - When Soda SQL runs a scan, it performs the following actions:</p> <ul> <li>fetches column metadata (column name, type, and nullable)</li> <li>executes a single aggregation query that computes aggregate metrics for multiple columns, such as <code class="language-plaintext highlighter-rouge">missing</code>, <code class="language-plaintext highlighter-rouge">min</code>, or <code class="language-plaintext highlighter-rouge">max</code></li> <li>for each column, executes several more queries, including <code class="language-plaintext highlighter-rouge">distinct_count</code>, <code class="language-plaintext highlighter-rouge">unique_count</code>, and <code class="language-plaintext highlighter-rouge">valid_count</code></li> </ul> <p><strong>4</strong> - By default, the output of a Soda SQL scan appears in your command-line interface. In the example below, Soda SQL executed three tests and all the tests passed. The <code class="language-plaintext highlighter-rouge">Exit code</code> is a process code: 0 indicates success with no test failures; a non-zero number indicates failures.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  | &lt; 200 <span class="o">{}</span>
  | 54 measurements computed
  | 3 tests executed
  | All is good. No tests failed.
  | Exiting with code 0
</code></pre></div></div> <p>In the following example, some of the tests Soda SQL executed failed, as indicated by <code class="language-plaintext highlighter-rouge">Exiting with code 2</code>. The scan output indicates which tests failed and why, so that you can investigate and resolve the issues in the warehouse.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  | &lt; 200 <span class="o">{}</span>
  | 304 measurements computed
  | 8 tests executed
  | 2 of 8 tests failed:
  |   Test column<span class="o">(</span>EMAIL<span class="o">)</span> <span class="nb">test</span><span class="o">(</span>missing_count <span class="o">==</span> 0<span class="o">)</span> failed with metric values <span class="o">{</span><span class="s2">"missing_count"</span>: 33<span class="o">}</span>
  |   Test column<span class="o">(</span>CREDIT_CARD_NUMBER<span class="o">)</span> <span class="nb">test</span><span class="o">(</span>invalid_percentage <span class="o">==</span> 0<span class="o">)</span> failed with metric values <span class="o">{</span><span class="s2">"invalid_percentage"</span>: 28.4<span class="o">}</span>
  | Exiting with code 2 
</code></pre></div></div> <h2 id="soda-sql-automation-and-integrations"> <a href="#soda-sql-automation-and-integrations" class="anchor-heading" aria-labelledby="soda-sql-automation-and-integrations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Soda SQL automation and integrations </h2> <p>To automate scans on your data, you can use the <strong>Soda SQL Python library</strong> to programmatically execute scans. Based on a set of conditions or a specific schedule of events, you can instruct Soda SQL to automatically scan for “bad” data. For example, you may wish to scan your data at several points along your data pipeline, perhaps when new data enters a warehouse, after it is transformed, and before it is exported to another warehouse. Refer to <a href="/soda-sql/documentation/programmatic_scan.html">Programmatic scan</a> for details.</p> <p>Alternatively, you can integrate Soda SQL with a <strong>data orchestration tool</strong> such as, Airflow, Dagster, or dbt, to schedule automated scans. You can also configure actions that the orchestration tool can take based on scan output. For example, if the output of a scan reveals a large number of failed tests, the orchestration tool can automatically quarantine the “bad” data or block it from contaminating your data pipeline. Refer to <a href="/soda-sql/documentation/orchestrate_scans.html">Orchestrate scans</a> for details.</p> <p>Additionally, you can integrate Soda SQL with a <strong>Soda Cloud</strong> account. This free, cloud-based web application integrates with your Soda SQL implementation giving your team broader visibility into your organization’s data quality. Soda SQL pushes scan results to your Soda Cloud account where you can use the web app to examine the results. Notably, Soda SQL only ever pushes <em>metadata</em> to the cloud; all your data stays inside your private network. Learn more about <a href="/soda-sql/documentation/soda-cloud-architecture.html">Soda Cloud architecture</a>.</p> <p>Though you do not have to set up and ingrate a Soda Cloud account in order to use Soda SQL, the web app serves to complement the CLI tool, giving you a non-CLI method of examining data quality. Use Soda Cloud to:</p> <ul> <li>collaborate with team members to review details of scan results that can help you to diagnose data issues</li> <li>use monitors to view stored <a href="/soda-sql/documentation/scan.html#scan-output">scan output</a> as a line graph that represents the volume of failed tests in each scan</li> <li>empower others to <a href="/soda-sql/documentation/monitors.html">set quality thresholds</a> that define “good” data</li> <li>set up and <a href="/soda-sql/documentation/monitors.html">send alert notifications</a> when “bad” data enters your data pipeline</li> </ul> <p>To connect Soda SQL to Soda Cloud, you create API keys in your Soda Cloud account and configure them as connection credentials in your Warehouse and env_vars YAML files. See <a href="/soda-sql/documentation/connect_to_cloud.html">Connect to Soda Cloud</a> for details.</p> <h2 id="go-further"> <a href="#go-further" class="anchor-heading" aria-labelledby="go-further"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Go further </h2> <ul> <li>Learn more about the contents of the <a href="/soda-sql/documentation/scan.html">Scan YAML</a> file.</li> <li>Learn more about the <a href="/soda-sql/documentation/sql_metrics.html">Metrics</a> you can use to define <a href="/soda-sql/documentation/tests.html">Tests</a>.</li> <li>Learn how to <a href="/soda-sql/documentation/connect_to_cloud.html">Connect to Soda Cloud</a>.</li> <li>See how to prepare <a href="/soda-sql/documentation/programmatic_scan.html">programmatic scans</a> of your data.</li> </ul> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
