<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Tests - Soda Documentation</title> <link rel="shortcut icon" href="/soda-sql/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/soda-sql/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/soda-sql/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/soda-sql/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Tests | Soda Documentation</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Tests" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Learn how to use Soda to test and monitor data quality." /> <meta property="og:description" content="Learn how to use Soda to test and monitor data quality." /> <link rel="canonical" href="/soda-sql/documentation/tests.html" /> <meta property="og:url" content="/soda-sql/documentation/tests.html" /> <meta property="og:site_name" content="Soda Documentation" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Tests" /> <script type="application/ld+json"> {"url":"/soda-sql/documentation/tests.html","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/soda-sql/assets/images/soda-logo.svg"}},"description":"Learn how to use Soda to test and monitor data quality.","@type":"WebPage","headline":"Tests","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/soda-sql/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"> <li class="nav-list-item "> <a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"> <use xlink:href="#svg-arrow-right"></use> </svg></a> <a class="nav-list-link" href="/soda-sql/getting-started/5_min_tutorial.html">Get Started</a> <ul class="nav-list "> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/getting-started/5_min_tutorial.html">Quick start tutorial</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/getting-started/installation.html">Install Soda SQL</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/getting-started/configure.html">Configure Soda SQL</a> </li> </ul> </li> <li class="nav-list-item active"> <a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"> <use xlink:href="#svg-arrow-right"></use> </svg></a> <a class="nav-list-link" href="/soda-sql/documentation/concepts.html">Documentation</a> <ul class="nav-list "> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/concepts.html">How Soda SQL works</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/cli.html">Soda SQL CLI commands</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/warehouse.html">Warehouse YAML</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/warehouse_types.html">Set warehouse configuration</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/scan.html">Scan YAML</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/sql_metrics.html">Metrics</a> </li> <li class="nav-list-item"> <a class="nav-list-link active" href="/soda-sql/documentation/tests.html">Tests</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/filtering.html">Apply filters</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/programmatic_scan.html">Configure programmatic scans</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/orchestrate_scans.html">Configure orchestrated scans</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/soda-cloud-architecture.html">Soda Cloud Architecture</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/connect_to_cloud.html">Connect to Soda Cloud</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/monitors.html">Create monitors and alerts</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/integrate-slack.html">Integrate with Slack</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/troubleshoot.html">Troubleshoot</a> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/documentation/glossary.html">Glossary</a> </li> </ul> </li> <li class="nav-list-item"> <a class="nav-list-link " href="/soda-sql/community.html">Community</a> </li> </ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Soda Documentation" aria-label="Search Soda Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/sodadata/soda-sql" class="site-button" > Soda SQL on GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="">Documentation</a></li> <li class="breadcrumb-nav-list-item"><span>Tests</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="tests"> <a href="#tests" class="anchor-heading" aria-labelledby="tests"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tests </h1> <p>A <strong>test</strong> is a check that Soda SQL performs when it scans a table in your warehouse. Technically, it is a Python expression that, during a Soda SQL scan, checks metrics to see if they match the parameters defined for a measurement. A single Soda SQL scan runs against a single table in your database, but each scan can run multiple tests.</p> <p>As a result of a scan, each test either passes or fails. When a test fails, it means that a property of the data in your table did not match the test parameters you defined. In other words, any test that returns <code class="language-plaintext highlighter-rouge">true</code> during a Soda SQL scan passes; any test that returns <code class="language-plaintext highlighter-rouge">false</code>, fails.</p> <p>The <strong>scan results</strong> in the command-line interface (CLI) include an exit code which is an indicator of the test results: <code class="language-plaintext highlighter-rouge">0</code> means all tests passed; a non-zero value means one or more tests have failed. See <a href="/soda-sql/documentation/scan.html#scan-output">Scan output</a> for details.</p> <h2 id="define-tests"> <a href="#define-tests" class="anchor-heading" aria-labelledby="define-tests"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Define tests </h2> <p>You define your tests in your <a href="/soda-sql/documentation/scan.html">scan YAML file</a> which is associated with a specific table in your database. You can write tests using <strong>default metrics</strong> that Soda SQL applies to an entire table (table metrics), or to individual columns you identify (column metrics). You can also write tests using <strong>custom metrics</strong> (SQL metrics) that you can apply to an entire table or individual columns. To learn more, see <a href="/soda-sql/documentation/sql_metrics.html">Metrics</a>.</p> <p>Regardless of where it applies, each test is comprised of three parts:</p> <ul> <li>a metric (a property of the data in your database)</li> <li>a comparison operator</li> <li>a value</li> </ul> <p>For example:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">tests</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">row_count &gt; </span><span class="m">0</span>
</code></pre></div></div> <p>However, where a test must determine whether or not data is valid, you must add a fourth element, a <strong>column configuration key</strong> to define what qualifies as valid. In the scan YAML file, you define a column configuration key before the test that will use the definition of “valid”.</p> <p>In the example below, the user defined the <code class="language-plaintext highlighter-rouge">valid_format</code> as <code class="language-plaintext highlighter-rouge">date_eu</code> or dd/mm/yyyy format. The metric <code class="language-plaintext highlighter-rouge">invalid_percentage</code> refers to the <code class="language-plaintext highlighter-rouge">valid_format</code> configuration key to determine if the data in the column is valid. To see a list of all available column configuration keys, see <a href="/soda-sql/documentation/sql_metrics.html#column-metrics">Column Metrics</a>.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">columns</span><span class="pi">:</span>
    <span class="na">start_date</span><span class="pi">:</span>
        <span class="na">valid_format</span><span class="pi">:</span> <span class="s">date_eu</span>
        <span class="na">tests</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="s">invalid_percentage &lt; </span><span class="m">2.0</span>
</code></pre></div></div> <p><br /></p> <h4 id="example-tests-using-default-metrics"> <a href="#example-tests-using-default-metrics" class="anchor-heading" aria-labelledby="example-tests-using-default-metrics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example tests using default metrics </h4> <p>Reference the table below which corresponds to the following example scan YAML file.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">table_name</span><span class="pi">:</span> <span class="s">demodata</span>
<span class="na">metrics</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">row_count</span>
  <span class="pi">-</span> <span class="s">missing_count</span>
  <span class="pi">-</span> <span class="s">missing_percentage</span>
  <span class="pi">-</span> <span class="s">values_count</span>
  <span class="pi">-</span> <span class="s">values_percentage</span>
  <span class="pi">-</span> <span class="s">valid_count</span>
  <span class="pi">-</span> <span class="s">valid_percentage</span>
  <span class="pi">-</span> <span class="s">invalid_count</span>
  <span class="pi">-</span> <span class="s">invalid_percentage</span>
  <span class="pi">-</span> <span class="s">...</span>
<span class="na">tests</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">row_count &gt; </span><span class="m">0</span>
<span class="na">columns</span><span class="pi">:</span>
  <span class="na">id</span><span class="pi">:</span>
    <span class="na">valid_format</span><span class="pi">:</span> <span class="s">uuid</span>
    <span class="na">tests</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">invalid_percentage == </span><span class="m">0</span>
  <span class="na">feepct</span><span class="pi">:</span>
    <span class="na">valid_format</span><span class="pi">:</span> <span class="s">number_percentage</span>
    <span class="na">tests</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">invalid_percentage == </span><span class="m">0</span>
</code></pre></div></div> <div class="table-wrapper"><table> <thead> <tr> <th>Default metric</th> <th>Comparison operator</th> <th>Value</th> <th>Applies to</th> <th>Test</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">row_count</code></td> <td><code class="language-plaintext highlighter-rouge">&gt;</code></td> <td><code class="language-plaintext highlighter-rouge">0</code></td> <td>whole table</td> <td>Checks to see if the table has at least one row. If the test fails, it means the table has no rows, which means that the table is empty.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">invalid_percentage</code></td> <td><code class="language-plaintext highlighter-rouge">==</code></td> <td><code class="language-plaintext highlighter-rouge">0</code></td> <td><code class="language-plaintext highlighter-rouge">id</code> column</td> <td>Checks to see if all rows in the id column contain data in a valid format. If the test fails, it means that more than 0% of the rows contain invalid data, which is data that is in non-UUID format.</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">invalid_percentage</code></td> <td><code class="language-plaintext highlighter-rouge">==</code></td> <td><code class="language-plaintext highlighter-rouge">0</code></td> <td><code class="language-plaintext highlighter-rouge">feepct</code> column</td> <td>Checks to see if all rows in the <code class="language-plaintext highlighter-rouge">feepct</code> column contain data in a valid format. If the test fails, it means that more than 0% of the rows contain invalid data, which is data that is not a numerical percentage.</td> </tr> </tbody> </table></div> <p><br /></p> <h4 id="example-tests-using-custom-metrics"> <a href="#example-tests-using-custom-metrics" class="anchor-heading" aria-labelledby="example-tests-using-custom-metrics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example tests using custom metrics </h4> <p>If the default set of table and column metrics that Soda SQL offers do not quite give you the information you need from a scan, you can use <strong>SQL metrics</strong> to customize your queries. SQL metrics essentially enable you to add SQL queries to your scan YAML file so that Soda SQL runs them during a scan. See <a href="/soda-sql/documentation/sql_metrics.html#sql-metrics">SQL metrics</a></p> <p>Reference the table below which corresponds to the following example scan YAML file.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">table_name</span><span class="pi">:</span> <span class="s">yourtable</span>
<span class="na">sql_metrics</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">sql</span><span class="pi">:</span> <span class="pi">|</span>
          <span class="s">SELECT sum(volume) as total_volume_us</span>
          <span class="s">FROM CUSTOMER_TRANSACTIONS</span>
          <span class="s">WHERE country = 'US'</span>
      <span class="na">tests</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">total_volume_us &gt; </span><span class="m">5000</span>
</code></pre></div></div> <div class="table-wrapper"><table> <thead> <tr> <th>Custom metric</th> <th>Comparison operator</th> <th>Value</th> <th>Applies to</th> <th>Test</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">total_volume_us</code></td> <td><code class="language-plaintext highlighter-rouge">&gt;</code></td> <td><code class="language-plaintext highlighter-rouge">5000</code></td> <td>whole table</td> <td>Checks to see if the sum of all customer transactions in the United States exceeds <code class="language-plaintext highlighter-rouge">5000</code>. If the test fails, it means that the total volume of transactions is less than <code class="language-plaintext highlighter-rouge">5000</code>.</td> </tr> </tbody> </table></div> <h2 id="define-test-names"> <a href="#define-test-names" class="anchor-heading" aria-labelledby="define-test-names"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Define test names </h2> <p>Soda SQL can run both anonymous or named tests. Named tests are useful if you intend to push Soda SQL scan results to your Soda Cloud account where you can update a test and retain its test history.</p> <p>Example of an anonymous test</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">tests</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">total_volume_us &gt; </span><span class="m">5000</span>
</code></pre></div></div> <p>Examples of named tests</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">tests</span><span class="pi">:</span>
    <span class="na">volume_test_max</span><span class="pi">:</span>  <span class="s">total_volume_us &gt; </span><span class="m">3000</span>
    <span class="na">volume_test_min</span><span class="pi">:</span>  <span class="s">total_volume_us &lt; </span><span class="m">5000</span>
</code></pre></div></div> <h2 id="go-further"> <a href="#go-further" class="anchor-heading" aria-labelledby="go-further"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Go further </h2> <ul> <li>Learn more about <a href="/soda-sql/documentation/sql_metrics.html">Metrics</a>.</li> <li>Learn about <a href="/soda-sql/documentation/concepts.html">How Soda works</a>.</li> </ul> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
